#pragma once

class RC4Cipher
{
private:
	byte engineState[256];
	byte* workingKey;
	int x;
	int y;

public:
	static constexpr byte key0[13]{ 0x6a,0x39,0x57,0x0c,0xc9,0xde,0x4e,0xc7,0x1d,0x64,0x82,0x18,0x94 }; //client to server
	static constexpr byte key1[13]{ 0xc7,0x93,0x32,0xb1,0x97,0xf9,0x2b,0xa8,0x5e,0xd2,0x81,0xa0,0x23 }; //server to client

	RC4Cipher(const byte* key);
	void reset();
	void cipher(byte* buffer, int size);
};